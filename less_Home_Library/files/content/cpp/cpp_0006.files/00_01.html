<head>
    <link rel="stylesheet" href="../../../css/books_style.css">
</head>

<body>
    <div>
        <p><a href="../cpp_0006.html">&lArr;Содержание</a></p>
        <h1>SFML и Visual Studio</h1>
        <hr>
        <h2>Вступление</h2>
        <p>Это руководство является первым, которое следует прочитать, если вы используете SFML с интегрированной средой разработки Visual Studio (компилятор Visual C++). В нем объясняется, как настроить ваши проекты SFML.</p>
        <hr>
        <h2>Установка SFML</h2>
        <p>Во-первых, вы должны загрузить SDK SFML со <a href="https://www.sfml-dev.org/download.php">страницы загрузки.</a></p>
        <div class="atention">
            <p>Вы должны загрузить пакет, соответствующий вашей версии Visual C++. Действительно, библиотека, скомпилированная с помощью VC++ 10 (Visual Studio 2010), например, не будет совместима с VC++ 12 (Visual Studio 2013). Если для вашей версии Visual
                C++ не скомпилирован пакет SFML, вам придется <a href="00_05.html">собрать
                SFML самостоятельно.</a></p>
        </div>
        <p>Затем вы можете распаковать архив SFML куда угодно. Копировать заголовки и библиотеки в вашу установку Visual Studio не рекомендуется, лучше хранить библиотеки в отдельном месте, особенно если вы собираетесь использовать несколько версий одной
            и той же библиотеки или несколько компиляторов.</p>
        <hr>
        <h2>Создание и настройка проекта SFML</h2>
        <p>Первое, что нужно сделать, это выбрать, какой проект создать. Рекомендуется выбрать «Пустой проект». Диалоговое окно предлагает несколько других параметров для настройки проекта: выберите «Консольное приложение» или «Приложение Windows», только
            если вы знаете, как использовать предварительно скомпилированные заголовки.</p>
        <p>Для целей этого руководства вы должны создать файл main.cpp и добавить его в проект, чтобы у нас был доступ к настройкам C++ (иначе Visual Studio не будет знать, какой язык вы собираетесь использовать для этого проекта). ). Мы объясним, что положить
            внутрь позже.</p>
        <p>Теперь нам нужно указать компилятору, где найти заголовки SFML (файлы .hpp), и компоновщику, где найти библиотеки SFML (файлы .lib).</p>
        <p>В свойствах проекта добавьте:</p>
        <ul>
            <li>Путь к заголовкам SFML (&lt;sfml-install-path&gt;/include) для C/C++ » General » Additional Include Directory</li>
            <li>Путь к библиотекам SFML (&lt;sfml-install-path&gt;/lib) в Linker » General » Additional Library Directorys</li>
            <img src="./00_01_01.png" alt="">
        </ul>
        <p>Эти пути одинаковы как в конфигурации отладки, так и в конфигурации выпуска, поэтому вы можете задать их глобально для своего проекта ("Все конфигурации").</p>
        <p>Следующий шаг — связать ваше приложение с библиотеками SFML (файлы .lib), которые потребуются вашему коду. SFML состоит из 5 модулей (системный, оконный, графический, сетевой и аудио), и для каждого из них имеется по одной библиотеке.</p>
        <p>Библиотеки нужно добавлять в свойствах проекта, в Linker » Input » Additional Dependencies. Добавьте все необходимые вам библиотеки SFML, например «sfml-graphics.lib», «sfml-window.lib» и «sfml-system.lib».</p>
        <img src="./00_01_02.png" alt="">
        <div class="atention">
            <p>Важно связать библиотеки, соответствующие конфигурации: «sfml-xxx-d.lib» для отладки и «sfml-xxx.lib» для выпуска. Плохая смесь может привести к сбоям.</p>
        </div>
        <p>Показанные здесь настройки приведут к тому, что ваше приложение будет связано с динамической версией SFML, которая нуждается в файлах DLL. Если вы хотите избавиться от этих DLL и напрямую интегрировать SFML в ваш исполняемый файл, вы должны создать
            ссылку на статическую версию. Статические библиотеки SFML имеют суффикс «-s»: «sfml-xxx-s-d.lib» для отладки и «sfml-xxx-s.lib» для выпуска. В этом случае вам также потребуется определить макрос SFML_STATIC в параметрах препроцессора вашего
            проекта.
        </p>
        <img src="./00_01_03.png" alt="">
        <div class="atention">
            <p>Начиная с SFML 2.2, при статической компоновке вам также придется связать все зависимости SFML с вашим проектом. Это означает, что если вы линкуете, например, sfml-window-s.lib или sfml-window-s-d.lib, вам также придется линковать opengl32.lib,
                winmm.lib и gdi32.lib. Некоторые из этих библиотек зависимостей уже могут быть перечислены в разделе «Унаследованные значения», но их повторное добавление не должно вызывать проблем.</p>
        </div>
        <p>Вот зависимости каждого модуля, добавьте -d, как описано выше, если вы хотите связать библиотеки отладки SFML:</p>
        <table class="table-td-left">
            <tr>
                <th class="table-en-ru">Модуль</th>
                <th class="table-en-ru">Зависимости</th>
            </tr>
            <tr>
                <td>
                    sfml-graphics-s.lib
                </td>
                <td>
                    <ul>
                        <li>sfml-window-s.lib</li>
                        <li>sfml-system-s.lib</li>
                        <li>opengl32.lib</li>
                        <li>freetype.lib</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>
                    sfml-window-s.lib
                </td>
                <td>
                    <ul>
                        <li>sfml-system-s.lib</li>
                        <li>opengl32.lib</li>
                        <li>winmm.lib</li>
                        <li>gdi32.lib</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>
                    sfml-audio-s.lib
                </td>
                <td>
                    <ul>
                        <li>sfml-system-s.lib</li>
                        <li>openal32.lib</li>
                        <li>flac.lib</li>
                        <li>vorbisenc.lib</li>
                        <li>vorbisfile.lib</li>
                        <li>vorbis.lib</li>
                        <li>ogg.lib</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>
                    sfml-network-s.lib
                </td>
                <td>
                    <ul>
                        <li>sfml-system-s.lib</li>
                        <li>ws2_32.lib</li>
                    </ul>
                </td>
            </tr>
            <tr>
                <td>
                    sfml-system-s.lib
                </td>
                <td>
                    <ul>
                        <li>winmm.lib</li>
                    </ul>
                </td>
            </tr>
        </table>
        <p>Вы могли заметить из таблицы, что модули SFML также могут зависеть друг от друга, например. sfml-graphics-s.lib зависит как от sfml-window-s.lib, так и от sfml-system-s.lib. Если вы статично связываетесь с библиотекой SFML, обязательно ссылайтесь
            на зависимости рассматриваемой библиотеки, а также на зависимости зависимостей и т. д. Если что-то в цепочке зависимостей отсутствует, вы получите ошибки компоновщика.</p>
        <p>Если вы немного запутались, не волнуйтесь, для новичков совершенно нормально быть перегруженным всей этой информацией о статической компоновке. Если что-то не работает у вас с первого раза, вы можете просто продолжать пробовать, всегда помня о
            том, что было сказано выше. Если вы по-прежнему не можете заставить статическую ссылку работать, вы можете проверить часто задаваемые вопросы и форум для тем, посвященных статической ссылке.</p>
        <p>Если вы не знаете различий между динамическими (также называемыми общими) и статическими библиотеками и не знаете, какую из них использовать, вы можете поискать дополнительную информацию в Интернете. О них есть много хороших статей/блогов/постов.</p>
        <p>Ваш проект готов, давайте напишем код, чтобы убедиться, что он работает. Поместите следующий код в файл main.cpp:</p>
        <code> 
            <p class="cpp_code">#include &lt;SFML/Graphics.hpp&gt;</p><br><p class="cpp_code">int main()</p>
                <p class="cpp_code">{</p>
                    <p class="cpp_code_1t">sf::RenderWindow window(sf::VideoMode(200, 200), "SFML works!");</p>
                    <p class="cpp_code_1t">sf::CircleShape shape(100.f);</p>
                    <p class="cpp_code_1t">shape.setFillColor(sf::Color::Green);</p><br>
                    <p class="cpp_code_1t">while (window.isOpen())</p>
                    <p class="cpp_code_1t">{</p>
                        <p class="cpp_code_2t">sf::Event event;</p>
                        <p class="cpp_code_2t">while (window.pollEvent(event))</p>
                        <p class="cpp_code_2t">{</p>
                            <p class="cpp_code_3t">if (event.type == sf::Event::Closed)</p>
                            <p class="cpp_code_3t">window.close();</p>
                            <p class="cpp_code_2t">}</p><br>
                            <p class="cpp_code_2t">window.clear();</p>
                            <p class="cpp_code_2t">window.draw(shape);</p>
                            <p class="cpp_code_2t">window.display();</p>
                            <p class="cpp_code_1t">}</p><br>
                            <p class="cpp_code_1t">return 0;</p>
                            <p class="cpp_code">}</p>
                        </code>
        <p>Если вы решили создать проект «приложение Windows», точка входа вашего кода должна быть установлена ​​на «WinMain» вместо «main». Поскольку это специфично для Windows, и поэтому ваш код не будет компилироваться в Linux или macOS, SFML предоставляет
            способ сохранить стандартную «основную» точку входа в этом случае: связать свой проект с модулем sfml-main («sfml-main-d.lib" в Debug, "sfml-main.lib" в Release), так же, как вы связали sfml-graphics, sfml-window и sfml-system.</p>
        <p>Теперь скомпилируйте проект, и если вы связались с динамической версией SFML, не забудьте скопировать библиотеки DLL SFML (они находятся в &lt;sfml-install-path/bin&gt;) в каталог, где находится ваш скомпилированный исполняемый файл. Запустите
            его, и если все работает, вы должны увидеть это:</p>
        <img src="./00_01_04.png" alt="">
        <p>Если вы используете модуль sfml-audio (независимо от того, статически он или динамически), вы также должны скопировать DLL необходимой ему внешней библиотеки, а именно OpenAL32.dll. Эти файлы также можно найти в &lt;sfml-install-path/bin&gt;.</p>
        <p><a href="./00_02.html">SFML и Code::Blocks (MinGW)&rArr;</a></p>
    </div>
</body>