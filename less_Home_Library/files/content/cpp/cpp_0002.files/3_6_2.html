<head>
    <link rel="stylesheet" href="../../css/books_style.css">
</head>

<body>
    <div class="book-title">
        <p><a href="./3_6_1.html">&lArr;3.6.1 Передача аргументов</a>&nbsp;&nbsp;&nbsp;<a href="../cpp_0002.html">Содержание</a>&nbsp;&nbsp;&nbsp;<a href="./3_6_3.html">3.6.3 Структурное связывание&rArr;</a></p>
        <h2>3.6.2. Возврат значения</h2>
        <hr>
        <div>
            <p>Как только мы вычислили результат, его нужно вывести из функции и вернуть вызывающей функции. И вновь по умолчанию возврат значения выполняется с помощью копирования, и для небольших объектов это оказывается идеальным решением. Мы возвращаем
                результат "по ссылке" только тогда, когда хотим предоставить вызывающей функции доступ к сущности, не являющейся локальной для этой функции. Например:</p>
            <img src="./3_6_2_p001.png" alt="">
            <p>i-й элемент Vector существует независимо от вызова оператора индекса, поэтому мы можем вернуть ссылку на него.</p>
            <p>С другой стороны, по завершении функции ее локальные переменные исчезают, поэтому мы не должны возвращать указатель или ссылку на них:</p>
            <img src="./3_6_2_p002.png" alt="">
            <p>К счастью, все основные компиляторы С++ в состоянии обнаружить эту очевидную ошибку в bad()</p>
            <p>Возврат ссылки или значения "малого" типа эффективно, но как же передавать из функции большие количества информации? Рассмотрим следующий код:</p>
            <img src="./3_6_2_p003.png" alt="">
            <p>Матрица Matrix может быть очень большой, с дорогостоящим копированием даже на современном аппаратном обеспечении. Поэтому, чтобы избежать копирования, мы создаем перемещающий конструктор Matrix (§5.2.2), а операция перемещения Matrix из оператора
                operator+ () оказывается очень дешевой. Нам не требуется возвращаться к ручному управлению памятью:</p>
            <img src="./3_6_2_p004.png" alt="">
            <p>К сожалению, возврат больших объектов путем возврата указателя на них весьма распространен в старом коде и является основным источником трудно обнаруживаемых ошибок. Не пишите такой код! Обратите внимание, что operator+ () так же эффективен,
                как и add (),но гораздо проще для определения, проще в использовании и менее подвержен ошибкам.</p>
            <p>Если функция не может выполнить требуемую задачу, она может сгенерировать исключение (§3.5.1 ). Это может помочь коду избежать переполненности проверками кодов ошибок для "исключительных проблем".</p>
            <p>Тип возвращаемой функции можно вывести из возвращаемого значения. Например:</p>
            <img src="./3_6_2_p005.png" alt="">
            <p>Это может быть удобно, в особенности для обобщенных функций (шаблонов функций, §6.3.1) и лямбда-выражений (§6.3.3), но их следует использовать осторожно, потому что выведенный тип не предлагает стабильного интерфейса: изменение в реализации
                функции (или лямбда-выражения) может изменить этот тип.</p>
        </div>
    </div>
</body>