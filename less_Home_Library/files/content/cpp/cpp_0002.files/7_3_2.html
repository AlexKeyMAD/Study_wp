<head>
    <link rel="stylesheet" href="../../css/books_style.css">
</head>

<body>
    <div class="book-title">
        <p><a href="./7_3_1.html">&lArr;7.3.1 Использование концептов</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="./7_4.html">7.4 Вариативные шаблоны&rArr;</a></p>
        <h2>7.3.2. Абстракции с использованием wаблонов</h2>
        <hr>
        <div>
            <p>Хорошие абстракции тщательно выращиваются из конкретных примеров. Не рекомендуется пытаться "абстрагироваться", стремясь предусмотреть все мыслимые потребности и методы; это направление к неэлегантному и раздутому коду. Вместо этого начните
                с одного - а лучше с нескольких - конкретных примеров реального использования и попытайтесь устранить несущественные детали. Рассмотрим следующий код:</p>
            <img src="./7_3_2_p001.png" alt="">
            <p>Очевидно, что это один из множества способов вычисления суммы последовательности чисел.</p>
            <p>Рассмотрим, что же делает этот код менее обобщенным, чем он должен быть.
            </p>
            <ul>
                <li>Почему только int?</li>
                <li>Почему только vector?</li>
                <li>Почему накапливание суммы выполняется в double?</li>
                <li>Почему начинаем с О?</li>
                <li>Почему суммируем?</li>
            </ul>
            <p>Отвечая на первые четыре вопроса превращением конкретных типов в аргументы шаблона, мы получаем простейшую форму алгоритма accumulate стандартной библиотеки:</p>
            <img src="./7_3_2_p002.png" alt="">
            <p>Теперь мы имеем следующее.</p>
            <ul>
                <li>Структура данных, которая должна быть обойдена, абстрагирована с помощью пары итераторов, представляющих последовательность ( § 12.1 ).</li>
                <li>Тип аккумулятора сделан параметром.</li>
                <li>Начальное значение теперь представляет собой входные данные; тип аккумулятора представляет собой тип этого начального значения.</li>
            </ul>
            <p>Быстрое исследование (или еще лучше - измерение) показывает, что код, сгенерированный для вызовов с различными структурами данных, идентичен коду, который вы получаете из исходного примера с ручным кодированием. Например:
            </p>
            <img src="./7_3_2_p003.png" alt="">
            <p>Процесс обобщения конкретного фрагмента кода (или нескольких фрагментов) при сохранении производительности называется подъемом (lifting). Наилучший способ разработки шаблона зачастую представляет собой такую последовательность действий:</p>
            <ul>
                <li>сначала разрабатывается конкретная версия;</li>
                <li>затем выполняются отладка, тестирование и измерения;</li>
                <li>и наконец конкретные типы заменяются аргументами шаблона.</li>
            </ul>
            <p>Обычно повторение begin () и end () утомляет, так что можно немного упростить пользовательский интерфейс: </p>
            <img src="./7_3_2_p004.png" alt="">
            <p>Для полной обобщенности мы можем абстрагировать и операцию +=; см.§ 14.3. </p>
        </div>
    </div>
</body>