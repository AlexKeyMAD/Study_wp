<head>
    <link rel="stylesheet" href="../../css/books_style.css">
</head>

<body>
    <div class="book-title">
        <p><a href="./2_3.html">&lArr;2.3. Классы</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="./2_5.html">2.5. Перечисления&rArr;</a></p>
        <h2>2.4. Объединения</h2>
        <hr>
        <div>
            <p>Объединение (union) представляет собой структуру (struct), в которой все члены располагаются по одному и тому же адресу, так что union занимает столько же памяти, сколько и его наибольший член. Естественно, union может хранить одновременно
                значение только одного члена. Например, рассмотрим запись таблицы символов, которая хранит имя и значение. Значение может иметь тип либо Node*, либо int:</p>
            <img src="./2_4_p001.png" alt="">
            <p>Члены р и i никогда не используются одновременно, так что получается пустая трата памяти. Ее легко избежать, указав, что оба члена являются членами union:</p>
            <img src="./2_4_p002.png" alt="">
            <p>Язык не отслеживает, какие значения хранятся в объединении, так что это должен делать программист :</p>
            <img src="./2_4_p003.png" alt="">
            <p>Поддержание соответствия между полем типа (здесь - t) и типом, содержащимся в объединении, чревато ошибками. Чтобы избежать ошибок, можно обеспечить это соответствие, инкапсулируя объединение и поле типа в класс и предлагая доступ только через
                функции-члены, которые гарантируют корректное использование объединения. На уровне приложений абстракции, основанные на таких маркированных объединениях (tagged unions), являются достаточно распространенными и полезными. Использование
                же "голых" объединений лучше всего свести к минимуму.</p>
            <p>Тип стандартной библиотеки variant может использоваться для устранения большинства прямых применений объединений. variant сохраняет значение одного из множества альтернативных типов (§13.5.1). Например, variant&lt;Node*, int&gt; может содержать
                либо Node*, либо int. </p>
            <p>С помощью variant пример Entry может быть записан следующим образом: </p>
            <img src="./2_4_p004.png" alt="">
            <p>Для множества применений variant проще и безопаснее, чем union. </p>
        </div>
    </div>
</body>