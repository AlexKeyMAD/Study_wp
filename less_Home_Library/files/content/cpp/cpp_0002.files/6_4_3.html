<head>
    <link rel="stylesheet" href="../../css/books_style.css">
</head>

<body>
    <div class="book-title">
        <p><a href="./6_4_2.html">&lArr;6.4.2 Псевдонимы</a>&nbsp;&nbsp;&nbsp;&nbsp;<a href="./6_5.html">6.5 Советы&rArr;</a></p>
        <h2>6.4.3. if времени компиляции</h2>
        <hr>
        <div>
            <p>Рассмотрим запись операции, которая может использовать один из двух вариантов операции- slow_and_safe (Т) или simple and_fast (Т). Такие проблемы часто встречаются в коде, где важны обобщенность и производительность. Традиционное решение состоит
                в том, чтобы написать пару перегруженных функций и выбирать наиболее подходящую на основе свойства (§ 13.9.1 ), такого как, например, свойство стандартной библиотеки is_pod. При использовании иерархии классов базовый класс может обеспечить
                общую операцию slow_and_safe, а производный класс - перекрыть ее реализацией simple_and_fast.</p>
            <p>В С++ 17 можно просто использовать if времени компиляции: </p>
            <img src="./6_4_3_p001.png" alt="">
            <p>is_pod&lt;T&gt; - это свойство типа (§ 13.9.1), которое говорит нам о том, может ли этот тип быть тривиально копирован. </p>
            <p>Инстанцируется только выбранная ветвь if constexpr. Это решение предлагает оптимальную производительность и локальность оптимизации.</p>
            <p>Что важно, if constexpr не является механизмом манипуляции текстом и не может нарушать обычные правила грамматики, типов и областей видимости. Например: </p>
            <img src="./6_4_3_p002.png" alt="">
            <p>Разрешение таких манипуляций текстом может серьезно подорвать удобочитаемость кода и создать проблемы для инструментов, основанных на современных методах представления программ (таких, как "абстрактные синтаксические деревья"). </p>
        </div>
    </div>
</body>